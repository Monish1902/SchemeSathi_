
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile in the SchemeSathi application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "firebaseUid": {
          "type": "string",
          "description": "The unique user ID provided by Firebase Authentication."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the user."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the user."
        },
        "email": {
          "type": "string",
          "description": "The email address of the user.",
          "format": "email"
        },
        "phone": {
          "type": "string",
          "description": "The phone number of the user."
        },
        "dateOfBirth": {
          "type": "string",
          "description": "The date of birth of the user.",
          "format": "date-time"
        },
        "address": {
          "type": "string",
          "description": "The address of the user."
        },
        "eligibilityCriteria": {
          "type": "array",
          "description": "The user's specific answers to eligibility criteria questions.",
          "items": {
            "type": "string"
          }
        },
        "vehiclesOwned": {
          "type": "boolean",
          "description": "Whether the user or their family owns a four-wheeler vehicle."
        },
        "houseType": {
          "type": "string",
          "enum": [
            "owned",
            "rented",
            "none"
          ],
          "description": "The user's housing situation."
        },
        "educationQualification": {
          "type": "string",
          "enum": [
            "uneducated",
            "1-10",
            "inter",
            "bachelors",
            "masters"
          ],
          "description": "The user's highest level of education."
        }
      },
      "required": [
        "id",
        "firebaseUid",
        "firstName",
        "lastName",
        "email",
        "dateOfBirth"
      ]
    },
    "GovernmentScheme": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "GovernmentScheme",
      "type": "object",
      "description": "Represents a government scheme available to users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the government scheme."
        },
        "name": {
          "type": "string",
          "description": "The name of the government scheme."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the government scheme."
        },
        "eligibilityCriteria": {
          "type": "array",
          "description": "The eligibility criteria for the scheme.",
          "items": {
            "type": "string"
          }
        },
        "benefits": {
          "type": "string",
          "description": "The benefits offered by the scheme."
        },
        "applicationProcess": {
          "type": "string",
          "description": "Instructions on how to apply for the scheme."
        },
        "websiteUrl": {
          "type": "string",
          "description": "The URL of the scheme's official website.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "eligibilityCriteria",
        "benefits",
        "applicationProcess",
        "websiteUrl"
      ]
    },
    "UserSchemeRecommendation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserSchemeRecommendation",
      "type": "object",
      "description": "Represents a scheme recommendation for a specific user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user scheme recommendation."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N UserSchemeRecommendation)"
        },
        "schemeId": {
          "type": "string",
          "description": "Reference to GovernmentScheme. (Relationship: GovernmentScheme 1:N UserSchemeRecommendation)"
        },
        "recommendationDate": {
          "type": "string",
          "description": "The date the scheme was recommended to the user.",
          "format": "date-time"
        },
        "matchScore": {
          "type": "number",
          "description": "The score representing how well the scheme matches the user's eligibility."
        },
        "reasoning": {
          "type": "string",
          "description": "The reasoning behind recommending this scheme to the user."
        }
      },
      "required": [
        "id",
        "userId",
        "schemeId",
        "recommendationDate",
        "matchScore",
        "reasoning"
      ]
    },
    "ApplicationStatus": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ApplicationStatus",
      "type": "object",
      "description": "Represents the status of a user's application for a specific scheme.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the application status."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N ApplicationStatus)"
        },
        "schemeId": {
          "type": "string",
          "description": "Reference to GovernmentScheme. (Relationship: GovernmentScheme 1:N ApplicationStatus)"
        },
        "applicationDate": {
          "type": "string",
          "description": "The date the user applied for the scheme.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The current status of the application (e.g., 'Submitted', 'Under Review', 'Approved', 'Rejected')."
        },
        "lastUpdated": {
          "type": "string",
          "description": "The last time the application status was updated.",
          "format": "date-time"
        },
        "notes": {
          "type": "string",
          "description": "Any notes or comments related to the application status."
        }
      },
      "required": [
        "id",
        "userId",
        "schemeId",
        "applicationDate",
        "status",
        "lastUpdated"
      ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification for a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the notification."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Notification)"
        },
        "message": {
          "type": "string",
          "description": "The content of the notification."
        },
        "type": {
          "type": "string",
          "description": "The type of notification (e.g., 'Scheme Update', 'Application Status')."
        },
        "timestamp": {
          "type": "string",
          "description": "The date and time the notification was sent.",
          "format": "date-time"
        },
        "isRead": {
          "type": "boolean",
          "description": "Indicates whether the notification has been read by the user."
        }
      },
      "required": [
        "id",
        "userId",
        "message",
        "type",
        "timestamp",
        "isRead"
      ]
    }
  },
  "auth": {
    "providers": [
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/userProfile",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information. Path-based ownership ensures only the authenticated user can access their profile.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase UID of the user."
            }
          ]
        }
      },
      {
        "path": "/governmentSchemes/{schemeId}",
        "definition": {
          "entityName": "GovernmentScheme",
          "schema": {
            "$ref": "#/backend/entities/GovernmentScheme"
          },
          "description": "Stores information about government schemes. Accessible to all users.",
          "params": [
            {
              "name": "schemeId",
              "description": "The unique ID of the government scheme."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/schemeRecommendations/{recommendationId}",
        "definition": {
          "entityName": "UserSchemeRecommendation",
          "schema": {
            "$ref": "#/backend/entities/UserSchemeRecommendation"
          },
          "description": "Stores scheme recommendations for a user. Path-based ownership ensures only the authenticated user can access their recommendations.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase UID of the user."
            },
            {
              "name": "recommendationId",
              "description": "The unique ID of the scheme recommendation."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/applicationStatuses/{applicationStatusId}",
        "definition": {
          "entityName": "ApplicationStatus",
          "schema": {
            "$ref": "#/backend/entities/ApplicationStatus"
          },
          "description": "Stores application statuses for a user's scheme applications. Path-based ownership ensures only the authenticated user can access their application statuses.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase UID of the user."
            },
            {
              "name": "applicationStatusId",
              "description": "The unique ID of the application status."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/notifications/{notificationId}",
        "definition": {
          "entityName": "Notification",
          "schema": {
            "$ref": "#/backend/entities/Notification"
          },
          "description": "Stores notifications for a user. Path-based ownership ensures only the authenticated user can access their notifications.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase UID of the user."
            },
            {
              "name": "notificationId",
              "description": "The unique ID of the notification."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure security, scalability, and debuggability, adhering to the principles of Authorization Independence, Clarity of Intent, DBAC, and QAPs. User data is stored under `/users/{userId}/userProfile` ensuring path-based ownership. Government schemes are stored in the `/governmentSchemes` collection. User-specific data, such as scheme recommendations, application statuses, and notifications, are stored within user-specific subcollections (e.g., `/users/{userId}/schemeRecommendations`). This design avoids hierarchical authorization dependencies, simplifies security rules, and enables secure list operations. Denormalization is not necessary in this design, given there is no collaborative data. QAPs is achieved by segregation. Each collection has uniform security rules. Authentication relies solely on `request.auth.uid`. Furthermore the structure is designed to efficiently model the relationships between users and the schemes they are recommended for or have applied to."
  }
}
